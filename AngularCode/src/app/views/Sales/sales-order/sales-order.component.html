<div class="col-md-12">
    <div class="card">
        <div class="card-header card-header-danger">
            <button type="button" class="btn btn-primary float-right btn-sm" id="AddCustomerbtn" data-toggle="modal"
                (click)="OpenSalesOrderModel()">
                Add Sales Order
            </button>
            <h4 class="card-title mt-0">Sale Order List</h4>
        </div>
        <div class="card-body bg-white">
            <div class="table-responsive animated flash">
                <table class="table " id="DisplayCustomerView">
                    <thead class="">
                        <th>
                            Sales Order
                        </th>
                        <th>
                            Sales Channel
                        </th>

                        <th>
                            Customer Name
                        </th>
                        <th>
                            Shipment
                        </th>
                        <th>
                            Payment
                        </th>
                        <th>
                            Total
                        </th>
                        <th>
                            Date Created
                        </th>
                        <th colspan="2" class="text-center">
                            Action
                        </th>
                    </thead>
                    <tbody class="LoderoutCustomer">
                        <tr *ngFor="let item of SalesOrderList" class="CustomerListID">
                            <td class="mr-2 text-center">
                                {{item.salesOrderNumber}}
                            </td>
                            <td class="mr-2">
                                <i *ngIf="item.salesOrderRepId==1" tooltip="Admin"
                                    class="fa h4 text-sucess fa-user"></i>
                                <i *ngIf="item.salesOrderRepId==2" tooltip="SalesMan"
                                    class="fa text-info h4 fa-group"></i>
                                <i *ngIf="item.salesOrderRepId==3" tooltip="Purchaser"
                                    class="fa h4 text-secondary fa-user"></i>
                                <i *ngIf="item.salesOrderRepId==4" tooltip="Operator"
                                    class="fa h4 text-warning fa-user"></i>
                                <i *ngIf="item.salesOrderRepId==5" tooltip="Manager"
                                    class="h4 text-primary  icon-people"></i>
                                <i *ngIf="item.salesOrderRepId==6" tooltip="Fulfillment" class="fa h4  fa-user"></i>

                            </td>

                            <td class="mr-2 ">
                                {{item.customerName}}
                            </td>
                            <td class="mr-2 text-center">
                                <span *ngIf="item.shipmentStatus==0" class="badge p-2 badge-secondary">In
                                    Progress</span>
                                <span *ngIf="item.shipmentStatus==1" class="badge p-2 badge-info">Partial Paid</span>
                                <span *ngIf="item.shipmentStatus==2" class="badge p-2 badge-success">Paid</span>
                                <span *ngIf="item.shipmentStatus==3" class="badge p-2 badge-danger">Issued</span>
                            </td>
                            <td class="mr-2">
                                <span *ngIf="item.paymentStatus==0" class="badge p-2 badge-secondary">In
                                    Progress</span>
                                <span *ngIf="item.paymentStatus==1" class="badge p-2 badge-success">Delivered</span>
                                <span *ngIf="item.paymentStatus==2" class="badge p-2 badge-info">Partial
                                    Delivered</span>
                                <span *ngIf="item.paymentStatus==3" class="badge p-2 badge-warning">Partially
                                    Issued</span>
                                <span *ngIf="item.paymentStatus==4" class="badge p-2 badge-danger">Issued</span>
                            </td>
                            <td class="mr-2">
                                {{SetFixedToDot(item.total)}}
                            </td>
                            <td class="mr-2">
                                {{item.dateOrdered | date}}
                            </td>
                            <td>
                                <i (click)="GetSalesOrder(item.salesOrdersId)"
                                    class="fa fa-pencil h5 pointer text-success"></i>
                            </td>

                            <td class="text-center">
                                <i (click)="DeleteSalesOrder(item.salesOrdersId)"
                                    class="fa fa-trash h5 pointer text-danger">
                                </i>
                            </td>
                        </tr>
                        <tr *ngIf="EmpltySalesOrderList">
                            <td colspan="9">
                                <div class="alert alert-success">Not Data Found</div>
                            </td>
                        </tr>
                    </tbody>
                </table>


                <div class="mt-2 mb-2 text-center LodersetEmployee" [hidden]="!loadSalesOrderList">
                    <div class="spinner-border text-danger" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div bsModal #largeModal="bs-modal" class="modal fade" tabindex="-1" [config]="{ backdrop: 'static' }" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">{{SaleTitle}}</h4>
                <button type="button" class="close" (click)="Close()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <tabset>
                    <tab id="TabOrderDetail">
                        <ng-template tabHeading><i class="fa fa-shopping-cart text-info"></i> Order Details
                        </ng-template>
                        <form [formGroup]="SalesOrderDetailsForm">
                            <input type="hidden" name="SalesOrdersId" id="SalesOrdersId"
                                formControlName="SalesOrdersId">
                            <input type="hidden" name="SalesOrderNumber" id="SalesOrderNumber"
                                formControlName="SalesOrderNumber">
                            <!-- <div class="row">
                                <div class="form-group col-sm-6">
                                    <label>FROM COMPANY</label>
                                    <select class="form-control" formControlName="FormCompany" id="FormCompany"
                                        [ngClass]="{ 'is-invalid': SalesOrderTabSubmit && f.FormCompany.errors }">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="tetant.userId" *ngFor="let tetant of TenantUserList">
                                            {{tetant.tenancyName}}({{tetant.userName}})</option>
                                    </select>
                                    <div *ngIf="SalesOrderTabSubmit && f.FormCompany.errors" class="invalid-feedback">
                                        <div *ngIf="f.FormCompany.errors.required">Company is required</div>
                                    </div>
                                </div>
                                <div class="form-group col-sm-4 mt-4">
                                    <label>Manage multiple companies under 1 inventory? <a href="#" class="">Create New
                                            Company</a></label>
                                </div>
                            </div> -->
                            <div class="row">

                                <div class="form-group col-sm-4">
                                    <label>SALES ORDER # </label>
                                    <p *ngIf="SalesOrderDetailsForm.value.SalesOrdersId==null || SalesOrderDetailsForm.value.SalesOrdersId=='0'"
                                        class="text-info">New</p>
                                    <p *ngIf="SalesOrderDetailsForm.value.SalesOrdersId!=null && SalesOrderDetailsForm.value.SalesOrdersId!=''"
                                        class="text-info">{{SalesOrderDetailsForm.value.SalesOrderNumber}}</p>
                                </div>
                                <div class="form-group col-sm-4">
                                    <label><i class="fa fa-calendar"></i> DATE ORDERED
                                    </label>
                                    <p *ngIf="SalesOrderDetailsForm.value.SalesOrdersId!=null && SalesOrderDetailsForm.value.SalesOrdersId!='' 
                                    && SalesOrderDetailsForm.value.SalesOrdersId!='0'"> {{CurrentDate |date}}</p>

                                    <!-- formControlName="DateOrdered" -->
                                    <input class="form-control" formControlName="DateOrdered"
                                        *ngIf="SalesOrderDetailsForm.value.SalesOrdersId==null || SalesOrderDetailsForm.value.SalesOrdersId=='0'"
                                        [disabled]="SalesOrderDetailsForm.value.SalesOrdersId!=0"
                                        [ngModel]="CurrentDate | date:'yyyy-MM-dd'" id="DateOrdered"
                                        [ngClass]="{'is-invalid': SalesOrderTabSubmit && f.DateOrdered.errors }"
                                        placeholder="DATE ORDERED" type="date">
                                    <div *ngIf="SalesOrderTabSubmit && f.DateOrdered.errors" class="invalid-feedback">
                                        <div *ngIf="f.DateOrdered.errors.required">Please Select
                                            Delivery Date</div>
                                    </div>
                                </div>
                                <div class="form-group col-sm-4">
                                    <label><i class="fa fa-calendar"></i> ESTIMATED DELIVERY DATE
                                    </label>
                                    <input class="form-control" formControlName="EstimatedDeliveryDate"
                                        [ngModel]="EstimatedDeliveryDate | date:'yyyy-MM-dd'" id="EstimatedDeliveryDate"
                                        [ngClass]="{'is-invalid': SalesOrderTabSubmit && f.EstimatedDeliveryDate.errors }"
                                        placeholder="DISCOUNT PERCENTAGE" type="date">
                                    <div *ngIf="SalesOrderTabSubmit && f.EstimatedDeliveryDate.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="f.EstimatedDeliveryDate.errors.required">Please Select Estimated
                                            Delivery Date</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label>CUSTOMER</label>
                                    <select class="form-control" (change)="CustomerChange($event.target.value)"
                                        formControlName="CustomerId" id="CustomerId"
                                        [ngClass]="{ 'is-invalid': SalesOrderTabSubmit && f.CustomerId.errors }">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="customer.customerId" *ngFor="let customer of CustomerList">
                                            {{customer.customerName}}</option>
                                    </select>
                                    <div *ngIf="SalesOrderTabSubmit && f.CustomerId.errors" class="invalid-feedback">
                                        <div *ngIf="f.CustomerId.errors.required">Customer is required</div>
                                    </div>
                                </div>
                                <div class="form-group col-sm-6" *ngIf="CustomerBillingAddress!=null">
                                    <label>SHIPPING ADDRESS </label>
                                    <a [routerLink]="['/customers/customer']" class="btn btn-link">Edit</a>
                                    <p class="h5">
                                        {{CustomerBillingAddress.address}},
                                        {{CustomerBillingAddress.state}},
                                        {{CustomerBillingAddress.city}},
                                        {{CustomerBillingAddress.postalCode}}

                                    </p>
                                </div>
                                <div class="form-group col-sm-6" *ngIf="CustomerShipingAddress!=null">
                                    <label>BILLING ADDRESS </label>
                                    <a [routerLink]="['/customers/customer']" class="btn btn-link">Edit</a>
                                    <p class="h5">
                                        {{CustomerShipingAddress.address}},
                                        {{CustomerShipingAddress.state}},
                                        {{CustomerShipingAddress.city}},
                                        {{CustomerShipingAddress.postalCode}}
                                    </p>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label>CUSTOMER'S PURCHASE ORDER NUMBER</label>
                                    <input class="form-control" formControlName="CustomerPurchesOrderNumber"
                                        id="CustomerPurchesOrderNumber" placeholder="CUSTOMER'S PURCHASE ORDER NUMBER"
                                        type="text">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>REMARKS</label>
                                    <input class="form-control" formControlName="Remarks" id="REMARKS"
                                        placeholder="REMARKS" type="text">
                                </div>
                            </div>
                        </form>
                    </tab>

                    <tab id="SaleOrderType">
                        <ng-template tabHeading><i class="fa fa-cart-arrow-down text-info"></i> Sales Order Type
                        </ng-template>
                        <form [formGroup]="SalesOrderTypeForm">
                            <div class="row">
                                <div class="form-group col-sm-12">
                                    <label>SALES ORDER TYPE </label>
                                    <select class="form-control" formControlName="SalesOrderTypeId"
                                        id="FormCSalesOrderTypeompany"
                                        [ngClass]="{ 'is-invalid': SalesOrderTabSubmitsecond && f1.SalesOrderTypeId.errors }">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="type.salesOrderTypeId" *ngFor="let type of SalesOrderTypeList">
                                            {{type.typeName}}</option>
                                    </select>
                                    <div *ngIf="SalesOrderTabSubmitsecond && f1.SalesOrderTypeId.errors"
                                        class="invalid-feedback">
                                        <div *ngIf="f1.SalesOrderTypeId.errors.required">Sales Order Type is required
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label>CREDIT TERMS </label>
                                    <select class="form-control" formControlName="CreditTermId" id="CreditTermId">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="creadit.creditTermId" *ngFor="let creadit of CreditTermsList">
                                            {{creadit.code}}</option>
                                    </select>
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>SHIPMENT METHOD </label>
                                    <select class="form-control" formControlName="ShipmentMethodId"
                                        id="ShipmentMethodId">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="creadit.shipmentMethodId"
                                            *ngFor="let creadit of ShipmentMethodList">{{creadit.code}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label>SALES REP</label>
                                    <select class="form-control" formControlName="SalesOrderRepId" id="SalesOrderRepId">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="ref.salesOrderRef" *ngFor="let ref of SalesOrderRefList">
                                            {{ref.name}}</option>

                                    </select>
                                </div>
                                <div class="form-group col-sm-6">
                                    <label>CURRENCY</label>
                                    <select class="form-control" formControlName="CurrencyId" id="CurrencyId">
                                        <option value="" selected>--Select--</option>
                                        <option [value]="currency.currencyId" *ngFor="let currency of CurrencyList">
                                            {{currency.currencyName}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-3"
                                    *ngIf="SalesOrderDetailsForm.value.SalesOrdersId!=null 
                                && SalesOrderDetailsForm.value.SalesOrdersId!=0 && OrderItemsForm.value.IsAdditionalChargeApply">
                                    ADDITIONAL CHARGES
                                    <i class="fa fa-info-circle text-info"
                                        tooltip="Specify additional charges 
                                    (eg: insurance or loading fees) if applicable. Additional cost will be 
                                    applied to 1 item or a group of items selling price or applied to entire sales order." placement="right"></i>
                                    <br />
                                    <button class="btn btn-primary btn-block"
                                        (click)="OpenAdditionlChargeModelandBindProduct(OrderItemsForm.value.IsAdditionalChargeApplyType)">Manage</button>
                                </div>
                                <div class="form-group col-sm-3" *ngIf="SalesOrderDetailsForm.value.SalesOrdersId==null 
                                || SalesOrderDetailsForm.value.SalesOrdersId==0">
                                    ADDITIONAL CHARGES
                                    <i class="fa fa-info-circle text-info"
                                        tooltip="Specify additional charges 
                                    (eg: insurance or loading fees) if applicable. Additional cost will be 
                                    applied to 1 item or a group of items selling price or applied to entire sales order." placement="right"></i>
                                    <br />
                                    <button class="btn btn-primary btn-block"
                                        (click)="OpenAdditionlChargeModel()">Manage</button>

                                </div>
                            </div>

                        </form>
                    </tab>
                    <tab id="SaleOrderItem">
                        <ng-template tabHeading><i class="fa fa-cubes text-info"></i> Order Items
                        </ng-template>
                        <form [formGroup]="OrderItemsForm">
                            <table class="table" formArrayName="OrderItems">
                                <tr>
                                    <th>ITEM</th>
                                    <th>UNIT</th>
                                    <th>UNIT PRICE</th>
                                    <th>QTY</th>
                                    <th>TYPE & DISCOUNT</th>
                                    <th>TAX</th>
                                    <th>TOTAL</th>
                                    <th>ACTION</th>
                                </tr>
                                <tr *ngFor="let item of OrderItems.controls; let pointIndex=index"
                                    [formGroupName]="pointIndex">
                                    <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                    <input type="hidden" name="" id="IsTaxble" formControlName="IsTaxble">
                                    <td>
                                        <div class="clo-sm-2">
                                            <select class="form-control" formControlName="ProductId"
                                                (change)="CheckIsTaxble($event.target,pointIndex)"
                                                [ngClass]="{ 'is-invalid': SalesOrdeItemTabSubmit && item.value.ProductId=='' }"
                                                id="ITEM">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="product.productId" [title]="product.taxable"
                                                    *ngFor="let product of ProductList">
                                                    {{product.name}}</option>
                                            </select>
                                            <div *ngIf="SalesOrdeItemTabSubmit && item.value.ProductId==''"
                                                class="invalid-feedback">
                                                <div>Product is required
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <label class="label label-success"> Unit [1]</label>
                                        <input type="hidden" formControlName="Unit" id="UNIT">
                                        <input type="hidden" formControlName="TaxTotal" id="TaxTotal">
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <input [readonly]="item.value.ProductId==''"
                                                (keypress)="allownumberwithdot($event)"
                                                [ngClass]="{ 'is-invalid': SalesOrdeItemTabSubmit && item.value.UnitPrice=='' || item.value.UnitPrice==null }"
                                                (change)="CalculateItemOrderData(item.value.UnitPrice,item.value.QTY,item.value.DiscountType,item.value.Discount,pointIndex,item.value.TaxId,item.value.Total)"
                                                class="form-control" formControlName="UnitPrice" id="UNITPRICE"
                                                placeholder="UNIT PRICE" type="number">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <input class="form-control" [readonly]="item.value.ProductId==''"
                                                [ngClass]="{ 'is-invalid': SalesOrdeItemTabSubmit && item.value.QTY=='' || item.value.QTY==null }"
                                                (change)="CalculateItemOrderData(item.value.UnitPrice,item.value.QTY,item.value.DiscountType,item.value.Discount,pointIndex,item.value.TaxId,item.value.Total)"
                                                (keypress)="allownumber($event)" formControlName="QTY" id="QTY"
                                                placeholder="QTY" type="number">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="input-group">
                                            <div class="input-group-append">
                                                <select class="form-control"
                                                    (change)="CalculateItemOrderData(item.value.UnitPrice,item.value.QTY,item.value.DiscountType,item.value.Discount,pointIndex,item.value.TaxId,item.value.Total)"
                                                    formControlName="DiscountType" id="DISCOUNT">
                                                    <option [value]="discount.discountTypeId"
                                                        *ngFor="let discount of  DiscountTypeList">{{discount.name}}
                                                    </option>
                                                </select>
                                            </div>
                                            <input *ngIf="item.value.DiscountType==1"
                                                [readonly]="item.value.ProductId==''"
                                                (change)="CalculateItemOrderData(item.value.UnitPrice,item.value.QTY,item.value.DiscountType,item.value.Discount,pointIndex,item.value.TaxId,item.value.Total)"
                                                class="form-control" formControlName="Discount" id="DISCOUNT"
                                                (keypress)="allownumberwithdot($event)" placeholder="Fixed"
                                                type="number">
                                            <input *ngIf="item.value.DiscountType!=1"
                                                [readonly]="item.value.ProductId==''" class="form-control"
                                                (change)="CalculateItemOrderData(item.value.UnitPrice,item.value.QTY,item.value.DiscountType,item.value.Discount,pointIndex,item.value.TaxId,item.value.Total)"
                                                formControlName="Discount" id="DISCOUNT"
                                                (keypress)="allownumberwithdot($event)" placeholder="Percentage"
                                                type="number">
                                        </div>
                                    </td>

                                    <td>
                                        <div class="clo-sm-2" *ngIf="item.value.IsTaxble">
                                            <select class="form-control"
                                                (change)="ChangeTaxValue($event.target.value,pointIndex,item.value.Total)"
                                                formControlName="TaxId" id="TAX">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">{{tax.code}}
                                                    ({{tax.amount}}%)</option>
                                            </select>
                                        </div>
                                        <!-- <div  *ngIf="!item.value.IsTaxble">
                                                <label class="text-info">Not Taxble..</label>
                                        </div> -->
                                    </td>
                                    <td class="text-right"><label class="mt-2">{{item.value.Total}}</label>
                                        <input type="hidden" name="" id="OrderItemsId" formControlName="Total">
                                    </td>
                                    <td class="text-center"> <i *ngIf="pointIndex!=0"
                                            class="fa fa-trash h5 mt-2 pointer text-danger"
                                            (click)="DeleteOrderItems(pointIndex)"></i></td>
                                </tr>
                                <tr>

                                    <td>
                                        <button class="btn btn-link" (click)="AddOrderItems()">Add New Item</button>
                                    </td>
                                    <td colspan="2">
                                        <label class="mt-2"> Maximum 100 items</label>
                                    </td>
                                    <td class="text-center">
                                        <label class="mt-2"> {{OrderItemsForm.value.TotalQTY}}</label>
                                    </td>
                                    <td colspan="3" class="text-right">
                                        <label class="mt-2">{{OrderItemsForm.value.Total}}</label>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td colspan="6" class="text-right">
                                        <label class="mt-2"><b class="mt-2">ADDITONAL CHARGE</b></label>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <label class="mt-2">{{OrderItemsForm.value.AdditionalChargeAmount}}</label>
                                    </td>
                                    <td> </td>
                                </tr>
                                <tr>
                                    <td colspan="6" class="text-right">
                                        <label class="mt-2"> <b *ngIf="OrderItemsForm.value.TaxInclude">PLUS
                                                TAX</b></label>
                                        <label class="mt-2"><b *ngIf="!OrderItemsForm.value.TaxInclude"
                                                class="mt-2">INCLUDED TAX </b></label>
                                    </td>
                                    <td colspan="1" class="text-right">
                                        <label class="mt-2"
                                            *ngIf="OrderItemsForm.value.TaxInclude">{{OrderItemsForm.value.FinalTaxTotal}}</label>
                                        <label class="mt-2" *ngIf="!OrderItemsForm.value.TaxInclude">0.00</label>
                                    </td>
                                    <td> </td>
                                </tr>
                                <tr>
                                    <td colspan="4" class="text-right">
                                        <label class="mt-2"> <b>INCLUDED TAX </b></label>
                                    </td>
                                    <td colspan="1" class="text-center">
                                        <label class="switch switch-3d mt-2 switch-success">
                                            <input type="checkbox" class="switch-input"
                                                (change)="ChangeTaxInclude($event.target.checked,OrderItemsForm.value.FinalTaxTotal,OrderItemsForm.value.FinalTotal)"
                                                [checked]="OrderItemsForm.value.TaxInclude">
                                            <!-- (change)="AdditionalChargeChange($event.target.checked,item.additionalChargeId)" -->
                                            <span class="switch-slider"></span>
                                        </label>
                                    </td>
                                    <td class="text-right h5">
                                        <label class="mt-2"> <b>TOTAL</b></label>
                                    </td>
                                    <td colspan="1" class="text-right h5">
                                        <label class="mt-2"><b>{{OrderItemsForm.value.FinalTotal}}</b></label>
                                    </td>
                                    <td></td>
                                </tr>
                            </table>
                            <input type="hidden" name="" id="SalesOrderDetailsId" formControlName="SalesOrderDetailsId">
                            <input type="hidden" name="TotalQTY" id="TotalQTY" formControlName="TotalQTY">
                            <input type="hidden" name="FinalTotal" id="FinalTotal" formControlName="FinalTotal">
                            <input type="hidden" name="TaxInclude" id="TaxInclude" formControlName="TaxInclude">
                            <input type="hidden" name="FinalTaxTotal" id="FinalTaxTotal"
                                formControlName="FinalTaxTotal">
                            <input type="hidden" name="AdditionalChargeAmount" id="AdditionalChargeAmount"
                                formControlName="AdditionalChargeAmount">
                            <input type="hidden" name="" id="IsAdditionalChargeApply"
                                formControlName="IsAdditionalChargeApply">
                            <input type="hidden" name="" id="IsAdditionalChargeApplyType"
                                formControlName="IsAdditionalChargeApplyType">

                        </form>
                    </tab>
                </tabset>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" [disabled]="saving" (click)="Close()">Close</button>
                <button type="button" class="btn btn-primary" [disabled]="saving"
                    (click)="SaveSalesOrder(SalesOrderDetailsForm,SalesOrderTypeForm,OrderItemsForm)">{{SavebtnTitle}}</button>

            </div>
        </div><!-- /.modal-content -->

    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div bsModal #largeModal1="bs-modal" class="modal fade" id="AdditionalChargeModel" tabindex="-1"
    [config]="{ backdrop: 'static' }" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Additional Charges {{AdditionalChargeActive}}</h4>
                <button type="button" class="close" (click)="CloseAdditionlChargeModel()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p> <i class="fa fa-info-circle text-warning"></i> You can add additional charges after shipping, but
                    cannot edit/add after creating invoices&hellip;</p>
                <div
                    *ngIf="SalesOrderDetailsForm.value.SalesOrdersId==null  || SalesOrderDetailsForm.value.SalesOrdersId==0">
                    <tabset>
                        <tab id="ForAll">
                            <ng-template tabHeading><a href="javascript:void"
                                    (click)="ResetAdditionalChargeForProduct()">
                                    <i class="fa fa-product-hunt text-info"></i> APPLY FOR ALL</a>
                            </ng-template>
                            <form [formGroup]="AdditionalChargeFormForAll">
                                <table class="table " formArrayName="AdditionalChargeForAll">
                                    <tr>
                                        <th>ADDITIONAL CHARGES</th>
                                        <th>AMOUNT</th>
                                        <th>TAXES</th>
                                        <th class="text-center">ACTION</th>
                                    </tr>
                                    <tr *ngFor="let item of AdditionalChargeForAll.controls; let pointIndex=index"
                                        [formGroupName]="pointIndex">
                                        <input type="hidden" name="" id="AdditionalForAllId"
                                            formControlName="AdditionalForAllId">
                                        <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                        <td>
                                            <div class="clo-sm-8">
                                                <select class="form-control" id="additionalChargeId"
                                                    formControlName="AdditionalChargeId"
                                                    (change)="ChangeAddAdditionalChargeForAll($event.target,pointIndex)"
                                                    [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.AdditionalChargeId==''}">
                                                    <option value="" selected>--Select--</option>
                                                    <option [value]="charge.additionalChargeId"
                                                        *ngFor="let charge of AdditionalChargeList"
                                                        [attr.title]="charge.unitPrice">{{charge.name}}</option>
                                                </select>
                                                <div *ngIf="AdditionalChargeSubmit && item.value.AdditionalChargeId==''"
                                                    class="invalid-feedback">
                                                    <div>Additional Charge is required
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-2">
                                                <input class="form-control" id="AMOUNT" formControlName="Amount"
                                                    placeholder="AMOUNT" type="number" (keypress)="allownumber()"
                                                    readonly
                                                    [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.Amount=='' || item.value.Amount==null}">
                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-2">
                                                <select class="form-control" id="Taxcode" formControlName="TaxId">
                                                    <option value="" selected>--Select--</option>
                                                    <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">
                                                        {{tax.code}}
                                                        ({{tax.amount}}%)</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td class="text-center">
                                            <i class="fa fa-trash h5 mt-2 pointer text-danger"
                                                (click)="DeleteAdditionalChargeForAll(pointIndex)"></i>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="4">
                                            <button type="button" class="btn btn-link"
                                                (click)="AddAdditionalChargeForAll()">Add More Additional
                                                Charge</button>
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </tab>
                        <tab id="ForProduct">
                            <ng-template tabHeading>
                                <a id="ForProduct" href="javascript:void" (click)="ResetAdditionalChargeForAll()">
                                    <i class="fa fa-product-hunt text-info"></i>APPLY TO PRODUCT</a>
                            </ng-template>
                            <form [formGroup]="AdditionalChargeFormForProduct">
                                <table class="table" *ngIf="IsProductSalesOrderItemAdded"
                                    formArrayName="AdditionalChargeForProduct">
                                    <tr>
                                        <th>PRODUCT(S)</th>
                                        <th>UOM</th>
                                        <th>ADDITIONAL CHARGES</th>
                                        <th>AMOUNT</th>
                                        <th>TAX</th>
                                    </tr>
                                    <tr [hidden]="IsProductLoad"
                                        *ngFor="let item of AdditionalChargeForProduct.controls; let pointIndex=index"
                                        [formGroupName]="pointIndex">
                                        <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                        <input type="hidden" name="" id="IsTaxble" formControlName="IsTaxble">
                                        <input type="hidden" name="" id="AdditionalForProductId"
                                            formControlName="AdditionalForProductId">
                                        <td>
                                            <div class="clo-sm-8">
                                                <select class="form-control" formControlName="ProductId" id="ProductId"
                                                    disabled>
                                                    <option value="" selected>--Select--</option>
                                                    <option [value]="product.productId"
                                                        *ngFor="let product of ProductList">
                                                        {{product.name}}</option>
                                                </select>
                                                <div *ngIf="AdditionalChargeSubmit && item.value.AdditionalChargeId==''"
                                                    class="invalid-feedback">
                                                    <div>Additional Charge is required
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-2">
                                                Unit[1]
                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-2">
                                                <select class="form-control" formControlName="AdditionalChargeId"
                                                    (change)="ChangeAddAdditionalChargeForProduct($event.target,pointIndex)"
                                                    [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.AdditionalChargeId==''}"
                                                    id="AdditionalCharge">
                                                    <option value="" selected>--Select--</option>
                                                    <option [value]="charge.additionalChargeId"
                                                        *ngFor="let charge of AdditionalChargeList"
                                                        [attr.title]="charge.unitPrice">{{charge.name}}</option>
                                                </select>

                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-2">
                                                <input class="form-control" readonly formControlName="Amount"
                                                    id="AMOUNT"
                                                    [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.Amount=='' || item.value.Amount==null}"
                                                    placeholder="AMOUNT" type="number">
                                            </div>
                                        </td>
                                        <td>
                                            <div class="clo-sm-3" *ngIf="item.value.IsTaxble">
                                                <select class="form-control" formControlName="TaxId" id="TaxId">
                                                    <option value="" selected>--Select--</option>
                                                    <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">
                                                        {{tax.code}}
                                                        ({{tax.amount}}%)</option>
                                                </select>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="text-center" *ngIf="IsProductLoad">
                                            <div class="spinner-border text-success" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <div [hidden]="IsProductSalesOrderItemAdded" class="alert alert-warning">No Product
                                    Seletced
                                    in Order Item Please Select Product Items..</div>
                            </form>
                        </tab>
                    </tabset>
                </div>
                <div
                    *ngIf="SalesOrderDetailsForm.value.SalesOrdersId!=null  && SalesOrderDetailsForm.value.SalesOrdersId!=0">
                    <div *ngIf="OrderItemsForm.value.IsAdditionalChargeApplyType=='All'">
                        <a href="javascript:void" >
                            <i class="fa fa-product-hunt text-info"></i> APPLY FOR ALL</a>
                        <form [formGroup]="AdditionalChargeFormForAll">
                            <table class="table " formArrayName="AdditionalChargeForAll">
                                <tr>
                                    <th>ADDITIONAL CHARGES</th>
                                    <th>AMOUNT</th>
                                    <th>TAXES</th>
                                    <th class="text-center">ACTION</th>
                                </tr>
                                <tr *ngFor="let item of AdditionalChargeForAll.controls; let pointIndex=index"
                                    [formGroupName]="pointIndex">
                                    <input type="hidden" name="" id="AdditionalForAllId"
                                        formControlName="AdditionalForAllId">
                                    <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                    <td>
                                        <div class="clo-sm-8">
                                            <select class="form-control" id="additionalChargeId"
                                                formControlName="AdditionalChargeId"
                                                (change)="ChangeAddAdditionalChargeForAll($event.target,pointIndex)"
                                                [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.AdditionalChargeId==''}">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="charge.additionalChargeId"
                                                    *ngFor="let charge of AdditionalChargeList"
                                                    [attr.title]="charge.unitPrice">{{charge.name}}</option>
                                            </select>
                                            <div *ngIf="AdditionalChargeSubmit && item.value.AdditionalChargeId==''"
                                                class="invalid-feedback">
                                                <div>Additional Charge is required
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <input class="form-control" id="AMOUNT" formControlName="Amount"
                                                placeholder="AMOUNT" type="number" (keypress)="allownumber()" readonly
                                                [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.Amount=='' || item.value.Amount==null}">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <select class="form-control" id="Taxcode" formControlName="TaxId">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">
                                                    {{tax.code}}
                                                    ({{tax.amount}}%)</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td class="text-center">
                                        <i class="fa fa-trash h5 mt-2 pointer text-danger"
                                            (click)="DeleteAdditionalChargeForAll(pointIndex)"></i>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="4">
                                        <button type="button" class="btn btn-link"
                                            (click)="AddAdditionalChargeForAll()">Add
                                            More Additional
                                            Charge</button>
                                    </td>
                                </tr>
                            </table>
                        </form>
                    </div>
                    <div  *ngIf="OrderItemsForm.value.IsAdditionalChargeApplyType=='Product'">
                        <a id="ForProduct" href="javascript:void" >
                            <i class="fa fa-product-hunt text-info"></i>APPLY TO PRODUCT</a>
                        <form [formGroup]="AdditionalChargeFormForProduct">
                            <table class="table" *ngIf="IsProductSalesOrderItemAdded"
                                formArrayName="AdditionalChargeForProduct">
                                <tr>
                                    <th>PRODUCT(S)</th>
                                    <th>UOM</th>
                                    <th>ADDITIONAL CHARGES</th>
                                    <th>AMOUNT</th>
                                    <th>TAX</th>
                                </tr>
                                <tr [hidden]="IsProductLoad"
                                    *ngFor="let item of AdditionalChargeForProduct.controls; let pointIndex=index"
                                    [formGroupName]="pointIndex">
                                    <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                    <input type="hidden" name="" id="IsTaxble" formControlName="IsTaxble">
                                    <input type="hidden" name="" id="AdditionalForProductId"
                                        formControlName="AdditionalForProductId">
                                    <td>
                                        <div class="clo-sm-8">
                                            <select class="form-control" formControlName="ProductId" id="ProductId"
                                                disabled>
                                                <option value="" selected>--Select--</option>
                                                <option [value]="product.productId" *ngFor="let product of ProductList">
                                                    {{product.name}}</option>
                                            </select>
                                            <div *ngIf="AdditionalChargeSubmit && item.value.AdditionalChargeId==''"
                                                class="invalid-feedback">
                                                <div>Additional Charge is required
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            Unit[1]
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <select class="form-control" formControlName="AdditionalChargeId"
                                                (change)="ChangeAddAdditionalChargeForProduct($event.target,pointIndex)"
                                                [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.AdditionalChargeId==''}"
                                                id="AdditionalCharge">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="charge.additionalChargeId"
                                                    *ngFor="let charge of AdditionalChargeList"
                                                    [attr.title]="charge.unitPrice">{{charge.name}}</option>
                                            </select>

                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-2">
                                            <input class="form-control" readonly formControlName="Amount" id="AMOUNT"
                                                [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.Amount=='' || item.value.Amount==null}"
                                                placeholder="AMOUNT" type="number">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="clo-sm-3" *ngIf="item.value.IsTaxble">
                                            <select class="form-control" formControlName="TaxId" id="TaxId">
                                                <option value="" selected>--Select--</option>
                                                <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">
                                                    {{tax.code}}
                                                    ({{tax.amount}}%)</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5" class="text-center" *ngIf="IsProductLoad">
                                        <div class="spinner-border text-success" role="status">
                                            <span class="sr-only">Loading...</span>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            <div [hidden]="IsProductSalesOrderItemAdded" class="alert alert-warning">No Product
                                Seletced
                                in Order Item Please Select Product Items..</div>
                        </form>
                    </div>
                </div>
                <!-- <div
                    *ngIf="SalesOrderDetailsForm.value.SalesOrdersId!=null  && SalesOrderDetailsForm.value.SalesOrdersId!=0">
                    <div *ngIf="OrderItemsForm.value.IsAdditionalChargeApplyType=='All'">
                        <h3>Additional charge for All</h3>
                        <div>
                            <table class="table ">
                                <tr>
                                    <th>ADDITIONAL CHARGES</th>
                                    <th>AMOUNT</th>
                                    <th>TAXES</th>
                                </tr>
                                <tr *ngFor="let item of AdditionalChargeForAll.controls; let pointIndex=index"
                                [formGroupName]="pointIndex">
                                <input type="hidden" name="" id="AdditionalForAllId"
                                    formControlName="AdditionalForAllId">
                                <input type="hidden" name="" id="OrderItemsId" formControlName="OrderItemsId">
                                <td>
                                    <div class="clo-sm-8">
                                        <select class="form-control" id="additionalChargeId"
                                            formControlName="AdditionalChargeId"
                                            (change)="ChangeAddAdditionalChargeForAll($event.target,pointIndex)"
                                            [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.AdditionalChargeId==''}">
                                            <option value="" selected>--Select--</option>
                                            <option [value]="charge.additionalChargeId"
                                                *ngFor="let charge of AdditionalChargeList"
                                                [attr.title]="charge.unitPrice">{{charge.name}}</option>
                                        </select>
                                        <div *ngIf="AdditionalChargeSubmit && item.value.AdditionalChargeId==''"
                                            class="invalid-feedback">
                                            <div>Additional Charge is required
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="clo-sm-2">
                                        <input class="form-control" id="AMOUNT" formControlName="Amount"
                                            placeholder="AMOUNT" type="number" (keypress)="allownumber()" readonly
                                            [ngClass]="{ 'is-invalid': AdditionalChargeSubmit && item.value.Amount=='' || item.value.Amount==null}">
                                    </div>
                                </td>
                                <td>
                                    <div class="clo-sm-2">
                                        <select class="form-control" id="Taxcode" formControlName="TaxId">
                                            <option value="" selected>--Select--</option>
                                            <option [value]="tax.taxId" *ngFor="let tax of TaxcodeList">{{tax.code}}
                                                ({{tax.amount}}%)</option>
                                        </select>
                                    </div>
                                </td>
                                <td class="text-center">
                                    <i class="fa fa-trash h5 mt-2 pointer text-danger"
                                        (click)="DeleteAdditionalChargeForAll(pointIndex)"></i>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    <button type="button" class="btn btn-link"
                                        (click)="AddAdditionalChargeForAll()">Add More Additional Charge</button>
                                </td>
                            </tr>

                            </table>
                        </div>
                    </div>
                    <div *ngIf="OrderItemsForm.value.IsAdditionalChargeApplyType=='Product'">
                        <h3>Additional charge for Product</h3>
                        <table class="table ">
                            <tr>
                                <th>PRODUCT(S)</th>
                                <th>UOM</th>
                                <th>ADDITIONAL CHARGES</th>
                                <th>AMOUNT</th>
                                <th>TAX</th>
                            </tr>
                            <tr *ngFor="let item of SalesOrderAdditionalchargeForProduct; let pointIndex=index">
                                <td>
                                    {{GetProductName(item.productId)}}
                                </td>
                                <td>
                                    Unit[1]
                                </td>
                                <td>
                                    {{GetAdditionalChargeName(item.additionalChargeId)}}
                                </td>
                                <td>
                                    {{GetAdditionalChargeAmount(item.additionalChargeId)}}
                                </td>
                                <td>
                                    {{GetTaxName(item.taxId)}}
                                </td>
                            </tr>

                        </table>
                    </div>
                </div> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" [disabled]="applysaving"
                    (click)="CloseAdditionlChargeModel()">Close</button>
                <button type="button" class="btn btn-primary"
                   
                    [disabled]="applysaving"
                    (click)="ApplyAdditionalCharge(AdditionalChargeForAll,AdditionalChargeForProduct)">Apply</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>